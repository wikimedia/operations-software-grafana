/*! grafana - v1.9.0 - 2014-11-10
 * Copyright (c) 2014 Torkel Ã–degaard; Licensed Apache License */

define(["./helpers","controllers/sharePanelCtrl"],function(a){describe("SharePanelCtrl",function(){var b=new a.ControllerTestContext;beforeEach(module("grafana.controllers")),beforeEach(b.providePhase()),beforeEach(b.createControllerPhase("SharePanelCtrl")),describe("shareUrl with current time range and panel",function(){it("should generate share url relative time",function(){b.$location.path("/test"),b.scope.panel={id:22},b.timeSrv.time={from:"now-1h",to:"now"},b.scope.buildUrl(),expect(b.scope.shareUrl).to.be("http://server/#/test?from=now-1h&to=now&panelId=22&fullscreen")}),it("should generate share url absolute time",function(){b.$location.path("/test"),b.scope.panel={id:22},b.timeSrv.time={from:new Date(13621788e5),to:new Date(13966488e5)},b.scope.buildUrl(),expect(b.scope.shareUrl).to.be("http://server/#/test?from=1362178800000&to=1396648800000&panelId=22&fullscreen")}),it("should generate share url with time as JSON strings",function(){b.$location.path("/test"),b.scope.panel={id:22},b.timeSrv.time={from:"2012-01-31T23:00:00.000Z",to:"2014-04-04T22:00:00.000Z"},b.scope.buildUrl(),expect(b.scope.shareUrl).to.be("http://server/#/test?from=1328050800000&to=1396648800000&panelId=22&fullscreen")}),it("should remove panel id when toPanel is false",function(){b.$location.path("/test"),b.scope.panel={id:22},b.scope.toPanel=!1,b.timeSrv.time={from:"now-1h",to:"now"},b.scope.buildUrl(),expect(b.scope.shareUrl).to.be("http://server/#/test?from=now-1h&to=now")}),it("should include template variables in url",function(){b.$location.path("/test"),b.scope.panel={id:22},b.scope.includeTemplateVars=!0,b.scope.toPanel=!1,b.templateSrv.variables=[{name:"app",current:{text:"mupp"}},{name:"server",current:{text:"srv-01"}}],b.timeSrv.time={from:"now-1h",to:"now"},b.scope.buildUrl(),expect(b.scope.shareUrl).to.be("http://server/#/test?from=now-1h&to=now&var-app=mupp&var-server=srv-01")})})})});