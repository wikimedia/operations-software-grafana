/*! grafana - v1.8.0 - 2014-09-08
 * Copyright (c) 2014 Torkel Ã–degaard; Licensed Apache License */

define(["mocks/dashboard-mock","./helpers","lodash","services/timeSrv"],function(a,b,c){describe("timeSrv",function(){var d,e=new b.ServiceTestContext;beforeEach(module("grafana.services")),beforeEach(e.providePhase()),beforeEach(e.createService("timeSrv")),beforeEach(function(){d=a.create(),e.service.init(d)}),describe("timeRange",function(){it("should return unparsed when parse is false",function(){e.service.setTime({from:"now",to:"now-1h"});var a=e.service.timeRange(!1);expect(a.from).to.be("now"),expect(a.to).to.be("now-1h")}),it("should return parsed when parse is true",function(){e.service.setTime({from:"now",to:"now-1h"});var a=e.service.timeRange(!0);expect(c.isDate(a.from)).to.be(!0),expect(c.isDate(a.to)).to.be(!0)})}),describe("setTime",function(){it("should return disable refresh for absolute times",function(){d.refresh=!1,e.service.setTime({from:"2011-01-01",to:"2015-01-01"}),expect(d.refresh).to.be(!1)}),it("should restore refresh after relative time range is set",function(){d.refresh="10s",e.service.setTime({from:"2011-01-01",to:"2015-01-01"}),expect(d.refresh).to.be(!1),e.service.setTime({from:"2011-01-01",to:"now"}),expect(d.refresh).to.be("10s")})})})});