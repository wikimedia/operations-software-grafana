/*! grafana - v1.8.0 - 2014-09-08
 * Copyright (c) 2014 Torkel Ã–degaard; Licensed Apache License */

define(["angular"],function(a){var b=a.module("grafana.controllers"),c=null;b.controller("InfluxTargetCtrl",["$scope","$timeout",function(b,d){b.init=function(){var a=b.target;a.function=a.function||"mean",a.column=a.column||"value",a.condition_value&&(a.condition=a.condition_key+" "+a.condition_op+" "+a.condition_value,delete a.condition_key,delete a.condition_op,delete a.condition_value),a.groupby_field_add===!1&&(a.groupby_field="",delete a.groupby_field_add),b.rawQuery=!1,b.functions=["count","mean","sum","min","max","mode","distinct","median","derivative","stddev","first","last","difference"],b.operators=["=","=~",">","<","!~","<>"],b.oldSeries=a.series,b.$on("typeahead-updated",function(){d(b.get_data)})},b.showQuery=function(){b.target.rawQuery=!0},b.hideQuery=function(){b.target.rawQuery=!1},b.seriesBlur=function(){b.oldSeries!==b.target.series&&(b.oldSeries=b.target.series,b.columnList=null,b.get_data())},b.changeFunction=function(a){b.target.function=a,b.get_data()},b.listColumns=function(a,c){return b.columnList?b.columnList:void b.$apply(function(){b.datasource.listColumns(b.target.series).then(function(a){b.columnList=a,c(a)})})},b.listSeries=function(a,d){return c&&""!==a?c:(c=[],void b.datasource.listSeries().then(function(a){c=a,d(c)}))},b.duplicate=function(){var c=a.copy(b.target);b.panel.targets.push(c)}}])});